# THETA 项目开发进度文档

> 本文档记录 THETA 项目的功能开发进度，每次完成一个功能后会在对应项打钩 ✅

**最后更新时间**: 2026-01-18

---

## 📋 功能模块清单

### 🎯 核心功能模块

#### 1. 数据管理模块 (Data Management)
- [x] 数据集列表展示
- [x] 数据集创建（上传文件）
- [x] 数据集删除
- [x] 数据集详情查看
- [x] 数据集文件管理（添加/删除文件）
- [x] 数据集重命名
- [x] 数据集搜索/筛选

#### 2. 数据清洗模块 (Data Cleaning)
- [x] 数据清洗任务创建
- [x] 数据清洗 API 集成
- [x] 清洗任务状态跟踪
- [x] 清洗结果文件下载
- [x] 直接上传已清洗数据
- [ ] 清洗规则配置界面
- [ ] 清洗预览功能
- [ ] 批量清洗任务 ⚠️

#### 3. 向量化模块 (Embedding & Preprocessing)
- [x] 向量化任务创建
- [x] BOW 矩阵生成
- [x] 词嵌入生成
- [x] 向量化进度显示
- [ ] 向量化参数配置（词汇量、嵌入维度等）
- [ ] 向量化结果预览
- [ ] 向量化结果导出

#### 4. 任务中心模块 (Task Center) - 已重构 ✅
- [x] 训练任务创建（向导式表单）
- [x] WebSocket 实时进度更新
- [x] 训练任务状态管理
- [x] 训练参数配置（主题数、epochs等）
- [x] 任务列表展示
- [x] 任务统计面板
- [x] 异步任务提交（Fire-and-Forget 模式）
- [x] 任务持久化存储（TaskStore）
- [x] 训练任务取消
- [ ] 训练任务暂停/恢复 ⚠️
- [ ] 训练历史记录 ⚠️
- [ ] 训练结果对比 ⚠️

#### 5. 结果分析模块 (Results Analysis)
- [x] 训练结果列表
- [x] 主题词展示
- [x] 主题分布可视化
- [x] 评估指标展示（coherence, perplexity等）
- [x] 文档-主题分布查看
- [ ] 主题演化分析（DETM）⚠️
- [x] 结果导出（CSV, JSON）

#### 6. 可视化模块 (Visualization)
- [x] 主题词云图
- [x] 主题分布热力图
- [x] 主题气泡图
- [x] 文档-主题分布图
- [x] 主题演化时间线
- [x] 交互式图表
- [x] 图表导出（PNG, SVG, PDF）

#### 7. AI 助手模块 (AI Assistant)
- [x] 基础聊天功能
- [x] 千问 API 集成
- [x] Markdown 格式回复
- [x] 打字动画效果
- [x] 界面状态感知
- [x] 对话历史持久化
- [x] 多轮对话上下文
- [x] 操作执行（创建任务、切换页面等）
- [x] 智能建议和推荐
- [x] 当前界面状态显示按钮
- [x] 清空对话功能
- [x] 历史对话记录管理
- [x] 新建对话功能
- [ ] 错误诊断和修复建议

#### 8. 用户认证模块 (Authentication)
- [x] 用户注册功能
- [x] 用户登录功能
- [x] JWT Token 认证
- [x] 用户信息管理
- [x] 登录/注册页面
- [x] 路由保护
- [x] 用户状态管理
- [x] 密码修改功能
- [x] 个人资料编辑
- [ ] 密码重置功能（忘记密码）⚠️
- [ ] 邮箱验证 ⚠️
- [x] 记住我功能
- [x] 密码强度检测
- [x] 密码可见性切换

---

### 🔧 技术功能

#### 9. 后端 API
- [x] RESTful API 基础框架
- [x] WebSocket 实时通信
- [x] 任务管理 API
- [x] 数据清洗 API 集成
- [x] ETM 训练 API
- [x] 聊天 API
- [ ] 文件上传 API（大文件分片）⚠️
- [ ] 文件下载 API
- [ ] 批量操作 API ⚠️
- [ ] API 文档（Swagger/OpenAPI）

#### 10. 前端 UI/UX
- [x] 响应式布局
- [x] 主题切换（明暗模式）
- [x] 路由导航
- [x] 状态管理
- [x] 错误处理
- [x] 加载状态
- [ ] 国际化（i18n）
- [ ] 无障碍访问（a11y）
- [ ] 性能优化（懒加载、虚拟滚动）
- [ ] 离线支持（PWA）⚠️

#### 11. 部署和运维
- [x] Docker 容器化
- [x] Docker Compose 配置
- [x] 服务器部署脚本
- [x] 部署文档
- [ ] 健康检查端点
- [ ] 日志聚合 ⚠️
- [ ] 监控和告警 ⚠️
- [ ] 备份和恢复 ⚠️

---

### 🐛 已知问题和待修复

#### 前端问题
- [x] 修复 React Hooks 顺序问题
- [ ] 优化大数据集加载性能
- [ ] 修复文件上传进度显示
- [ ] 优化 WebSocket 重连机制

#### 后端问题
- [ ] 优化大文件处理性能 ⚠️
- [ ] 添加请求限流
- [ ] 完善错误处理
- [ ] 添加数据验证

---

### 📝 文档和测试

#### 文档
- [x] README.md
- [x] README_CN.md
- [x] 部署文档
- [ ] API 文档
- [ ] 用户手册
- [ ] 开发者指南
- [ ] 架构设计文档

#### 测试
- [ ] 单元测试（前端）
- [ ] 单元测试（后端）⚠️
- [ ] 集成测试 ⚠️
- [ ] E2E 测试 ⚠️
- [ ] 性能测试 ⚠️

---

## ✅ 可独立推进的任务

> 这些任务主要是前端 UI/UX 改进、简单的后端逻辑，**不需要外部依赖**，可以立即开始。

### 数据管理模块（前端为主）
| 任务 | 说明 | 难度 |
|------|------|------|
| 数据集列表展示 | 前端展示逻辑，已有 mock 数据 | ⭐ |
| 数据集创建（上传文件） | 前端上传 UI + 简单后端 API | ⭐⭐ |
| 数据集删除 | 前端确认弹窗 + 后端删除 API | ⭐ |
| 数据集详情查看 | 前端详情页展示 | ⭐ |
| 数据集重命名 | 前端编辑 UI + 后端更新 API | ⭐ |
| 数据集搜索/筛选 | 纯前端实现 | ⭐ |

### 数据清洗模块
| 任务 | 说明 | 难度 |
|------|------|------|
| 清洗规则配置界面 | 前端表单 UI | ⭐⭐ |
| 清洗预览功能 | 前端预览 + 后端预览 API | ⭐⭐ |

### 向量化模块
| 任务 | 说明 | 难度 |
|------|------|------|
| 向量化参数配置 | 前端配置表单 | ⭐⭐ |
| 向量化结果预览 | 前端展示矩阵形状、样本词等 | ⭐⭐ |
| 向量化结果导出 | 前端下载按钮 + 后端导出 API | ⭐ |

### 结果分析模块
| 任务 | 说明 | 难度 |
|------|------|------|
| 主题分布可视化 | 已有可视化组件，集成到结果页 | ⭐ |
| 文档-主题分布查看 | 已有组件，需接入数据 | ⭐ |

### AI 助手模块
| 任务 | 说明 | 难度 |
|------|------|------|
| 错误诊断和修复建议 | 扩展 AI 提示词，增加错误处理逻辑 | ⭐⭐ |

### 用户认证模块
| 任务 | 说明 | 难度 |
|------|------|------|
| 记住我功能 | 前端 localStorage + token 延长 | ⭐ |
| 密码重置功能（无邮箱版） | 安全问题验证方式 | ⭐⭐ |

### 前端 UI/UX
| 任务 | 说明 | 难度 |
|------|------|------|
| 国际化（i18n） | 使用 next-intl 或 i18next | ⭐⭐⭐ |
| 性能优化（懒加载） | React.lazy + Suspense | ⭐⭐ |
| 优化 WebSocket 重连机制 | 前端连接管理 | ⭐⭐ |

### 后端 API
| 任务 | 说明 | 难度 |
|------|------|------|
| 健康检查端点 | 简单的 /health API | ⭐ |
| API 文档（Swagger） | FastAPI 自带，需配置 | ⭐⭐ |
| 添加请求限流 | FastAPI middleware | ⭐⭐ |
| 完善错误处理 | 统一异常处理 | ⭐⭐ |
| 文件下载 API | 支持结果文件下载 | ⭐⭐ |

### 文档
| 任务 | 说明 | 难度 |
|------|------|------|
| API 文档 | 基于 Swagger 生成 | ⭐⭐ |
| 用户手册 | Markdown 文档 | ⭐⭐ |

---

## ⚠️ 需要其他成员支持的任务

> 这些任务需要后端 ETM 环境、外部服务集成或基础设施支持，标记为 ⚠️

### 需要 ETM 后端环境支持
| 任务 | 依赖说明 | 需要谁 |
|------|----------|--------|
| **训练任务暂停/恢复** | 需要 ETM 训练进程支持中断和恢复 | 后端/ML 工程师 |
| **训练任务取消** | 需要安全终止训练进程 | 后端/ML 工程师 |
| **训练历史记录** | 需要数据库持久化训练记录 | 后端工程师 |
| **训练结果对比** | 需要多个训练结果的存储和查询 | 后端工程师 |
| **主题演化分析（DETM）** | 需要 DETM 模型实现和 API | ML 工程师 |
| **批量清洗任务** | 需要后端任务队列支持 | 后端工程师 |
| **大文件分片上传** | 需要后端分片合并逻辑 | 后端工程师 |
| **大文件处理性能优化** | 需要后端流式处理 | 后端工程师 |

### 需要外部服务集成
| 任务 | 依赖说明 | 需要谁 |
|------|----------|--------|
| **邮箱验证** | 需要邮件服务（SMTP/SendGrid/阿里云邮件） | 运维/后端 |
| **密码重置（邮箱版）** | 需要邮件服务 + 重置链接生成 | 运维/后端 |

### 需要基础设施支持
| 任务 | 依赖说明 | 需要谁 |
|------|----------|--------|
| **日志聚合** | 需要 ELK/Loki 等日志系统 | 运维工程师 |
| **监控和告警** | 需要 Prometheus/Grafana 等监控系统 | 运维工程师 |
| **备份和恢复** | 需要数据库备份策略和脚本 | 运维工程师 |
| **离线支持（PWA）** | 需要 Service Worker + 缓存策略 | 前端 + 后端协调 |

### 需要测试环境
| 任务 | 依赖说明 | 需要谁 |
|------|----------|--------|
| **单元测试（后端）** | 需要测试数据和 ETM 环境 | 后端工程师 |
| **集成测试** | 需要完整的测试环境 | QA/测试工程师 |
| **E2E 测试** | 需要 Playwright/Cypress 环境 | 前端 + QA |
| **性能测试** | 需要压测工具和环境 | 运维/QA |

---

## 🎯 当前优先级

### 高优先级（P0）
1. ✅ AI 助手界面状态感知
2. ✅ 可视化模块实现
3. ✅ 数据管理模块完善（CRUD 操作）
4. ✅ 结果分析模块集成可视化

### 中优先级（P1）
1. ✅ 对话历史持久化
2. ✅ 记住我功能
3. ✅ 用户认证完善（密码修改、资料编辑）
4. [ ] 文件上传/下载优化
5. [ ] API 文档完善
6. [ ] 错误处理优化

### 低优先级（P2）
1. [ ] 国际化支持
2. [ ] 性能优化
3. [ ] 测试覆盖
4. [ ] 监控和告警

---

## 📊 完成度统计

- **数据管理**: 100% (7/7) ✅
- **数据清洗**: 63% (5/8)
- **向量化**: 57% (4/7)
- **模型训练**: 50% (4/8)
- **结果分析**: 86% (6/7)
- **可视化**: 100% (7/7) ✅
- **AI 助手**: 93% (13/14)
- **后端 API**: 60% (6/10)
- **前端 UI/UX**: 60% (6/10)
- **部署运维**: 50% (4/8)
- **用户认证**: 100% (13/13) ✅

**总体完成度**: ~72%

---

## 📅 开发日志

### 2025-01-17（深夜 续）
- ✅ **AI 助手功能增强**
  - ✅ 当前界面状态显示 - 点击"状态"按钮显示当前页面、数据集等信息
  - ✅ 清空对话功能 - 支持"新建"（保存并清空）和"清空"（不保存）
  - ✅ 历史对话记录 - 保存最近20个对话会话，支持切换和删除
  - ✅ 对话会话管理 - 自动提取对话标题，显示时间和消息数

### 2025-01-17（深夜）
- ✅ **完善用户认证模块**（100%）
  - ✅ 密码修改功能 - 后端API + 前端弹窗
  - ✅ 个人资料编辑 - 支持修改邮箱和姓名
  - ✅ 密码强度检测 - 实时显示密码强度指示器
  - ✅ 密码可见性切换 - 登录/注册页面都支持
  - ✅ 路由保护优化 - ProtectedRoute组件保护主页面
  - ✅ 用户下拉菜单 - 添加个人资料和修改密码入口
  - ✅ 后端SECRET_KEY配置 - 从配置文件读取，支持环境变量
  - ✅ 登录页面UI优化 - 渐变背景、Logo图标、更好的表单样式
  - ✅ 注册页面UI优化 - 密码验证清单、实时反馈

### 2025-01-17（晚）
- ✅ **完成数据管理模块全部功能**（100%）
  - ✅ 数据集列表展示 - 优化UI布局，响应式网格设计
  - ✅ 数据集创建（上传文件）- 完善上传流程和弹窗UI
  - ✅ 数据集删除 - 添加确认弹窗，显示详细信息
  - ✅ 数据集详情查看 - 完整的详情页面和文件列表
  - ✅ 数据集文件管理 - 支持添加/删除文件，拖拽上传
  - ✅ 数据集重命名 - 添加重命名弹窗和功能
  - ✅ 数据集搜索/筛选 - 按名称/ID搜索，支持日期/名称/文件数排序
- ✅ **完善结果分析模块**
  - ✅ 主题分布可视化 - 集成InteractiveChart到结果页
  - ✅ 文档-主题分布查看 - 添加文档-主题分布图表
  - ✅ 后端可视化数据加载 - 集成getVisualizationData API
- ✅ **用户认证功能增强**
  - ✅ 记住我功能 - 登录页面添加"记住我"选项，自动填充用户名
- ✅ **UI/UX优化**
  - ✅ 响应式设计完善 - 所有页面适配移动端/平板/桌面
  - ✅ 交互式图表优化 - 热力图、词云等图表响应式改进
  - ✅ 弹窗UI优化 - 上传已清洗数据弹窗使用现代化设计

### 2025-01-17
- ✅ 实现可视化模块 - 完整的交互式图表系统
  - ✅ 主题词云图组件
  - ✅ 主题分布图（条形图、饼图）
  - ✅ 主题相似度热力图
  - ✅ 主题气泡图
  - ✅ 文档-主题分布图
  - ✅ 主题演化时间线
  - ✅ 图表导出功能（PNG, SVG）
  - ✅ 后端可视化数据 API
- ✅ 修复 React state 声明顺序问题

### 2025-01-13
- ✅ 实现 AI 助手界面状态感知功能
- ✅ 修复 React Hooks 顺序问题
- ✅ 完善 AI 助手打字动画效果
- ✅ 完善 AI 助手 Markdown 格式支持
- ✅ 完善结果分析页面 - 实现导出功能（CSV/JSON）
- ✅ 修复 API 路径问题（topic-words）
- ✅ 完善结果分析模块
  - ✅ 更新前端 ResultInfo 接口以匹配后端 schema
  - ✅ 完善训练结果列表展示（添加时间戳格式化、指标预览等）
  - ✅ 完善主题词展示（优化布局、排序、样式）
  - ✅ 完善评估指标展示（格式化指标名称、优化显示）
- ✅ 实现用户注册登录功能 - 后端API（注册、登录、JWT认证）
- ✅ 实现用户注册登录功能 - 前端UI（登录页面、注册页面）
- ✅ 实现用户注册登录功能 - 路由保护和状态管理
- ✅ 实现对话历史持久化 - 前端 localStorage 存储和加载
- ✅ 实现对话历史持久化 - 后端 API 端点（保存/获取/清除历史）
- ✅ 完善操作执行功能 - 支持多种操作类型（navigate, start_task, show_results 等）
- ✅ 添加智能建议功能 - 基于当前上下文提供个性化建议

---

## ❓ 待确认事项

> 需要与团队成员确认的技术决策

1. **邮箱服务选型** - 是否使用阿里云邮件/SendGrid？还是暂不实现邮箱功能？
2. **ETM 环境状态** - 当前 `SIMULATION_MODE=True`，真实训练何时可用？
3. **数据库选型** - 目前用内存存储，是否需要 PostgreSQL/MongoDB？
4. **监控方案** - 是否有现成的监控基础设施（Prometheus/Grafana）？
5. **DETM 支持** - 是否需要支持动态主题模型？优先级如何？

---

## 📝 备注

- ⚠️ 标记的任务需要其他成员支持
- 本文档会随着开发进度持续更新
- 每次完成功能后请及时更新对应项的完成状态
- 如有问题或建议，请在文档中记录
